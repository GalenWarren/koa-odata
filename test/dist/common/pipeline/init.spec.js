"use strict";

var Promise = require("bluebird");
var testUtilities = require("../utilities");
var pipelineUtilities = require("./utilities");
var expect = require("chai").expect;

var initModule = testUtilities.sourceRequire("lib/pipeline/init");
var stateModule = testUtilities.sourceRequire("lib/pipeline/state");

describe("InitPipelineComponent", function () {

  it("adds an instance of ODataState to the context state", function (done) {

    var init = new initModule.InitPipelineComponent({});

    var context = {
      state: {}
    };

    pipelineUtilities.testPipelineProcess(init, context).then(function () {

      expect(context.state.odata).to.be.an.instanceOf(stateModule.ODataState);
    }).then(done, done);
  });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBpcGVsaW5lL2luaXQuc3BlYy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLElBQUksT0FBTyxHQUFHLE9BQU8sQ0FBQyxVQUFVLENBQUMsQ0FBQztBQUNsQyxJQUFJLGFBQWEsR0FBRyxPQUFPLENBQUMsY0FBYyxDQUFDLENBQUM7QUFDNUMsSUFBSSxpQkFBaUIsR0FBRyxPQUFPLENBQUMsYUFBYSxDQUFDLENBQUM7QUFDL0MsSUFBSSxNQUFNLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLE1BQU0sQ0FBQzs7QUFFcEMsSUFBSSxVQUFVLEdBQUcsYUFBYSxDQUFDLGFBQWEsQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDO0FBQ2xFLElBQUksV0FBVyxHQUFHLGFBQWEsQ0FBQyxhQUFhLENBQUMsb0JBQW9CLENBQUMsQ0FBQzs7QUFFcEUsUUFBUSxDQUFDLHVCQUF1QixFQUFFLFlBQVc7O0FBRTNDLElBQUUsQ0FBQyxxREFBcUQsRUFBRSxVQUFVLElBQUksRUFBRzs7QUFFekUsUUFBTSxJQUFJLEdBQUcsSUFBSSxVQUFVLENBQUMscUJBQXFCLENBQUMsRUFBRSxDQUFDLENBQUM7O0FBRXRELFFBQU0sT0FBTyxHQUFHO0FBQ2QsV0FBSyxFQUFFLEVBQUU7S0FDVixDQUFDOztBQUVGLHFCQUFpQixDQUFDLG1CQUFtQixDQUFFLElBQUksRUFBRSxPQUFPLENBQUUsQ0FBQyxJQUFJLENBQUUsWUFBVzs7QUFFdEUsWUFBTSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsVUFBVSxDQUFDLFdBQVcsQ0FBQyxVQUFVLENBQUMsQ0FBQztLQUV6RSxDQUFDLENBQUMsSUFBSSxDQUFFLElBQUksRUFBRSxJQUFJLENBQUUsQ0FBQztHQUV2QixDQUFDLENBQUM7Q0FFSixDQUFDLENBQUMiLCJmaWxlIjoicGlwZWxpbmUvaW5pdC5zcGVjLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIFByb21pc2UgPSByZXF1aXJlKFwiYmx1ZWJpcmRcIik7XG52YXIgdGVzdFV0aWxpdGllcyA9IHJlcXVpcmUoXCIuLi91dGlsaXRpZXNcIik7XG52YXIgcGlwZWxpbmVVdGlsaXRpZXMgPSByZXF1aXJlKFwiLi91dGlsaXRpZXNcIik7XG52YXIgZXhwZWN0ID0gcmVxdWlyZShcImNoYWlcIikuZXhwZWN0O1xuXG52YXIgaW5pdE1vZHVsZSA9IHRlc3RVdGlsaXRpZXMuc291cmNlUmVxdWlyZShcImxpYi9waXBlbGluZS9pbml0XCIpO1xudmFyIHN0YXRlTW9kdWxlID0gdGVzdFV0aWxpdGllcy5zb3VyY2VSZXF1aXJlKFwibGliL3BpcGVsaW5lL3N0YXRlXCIpO1xuXG5kZXNjcmliZShcIkluaXRQaXBlbGluZUNvbXBvbmVudFwiLCBmdW5jdGlvbigpIHtcblxuICBpdChcImFkZHMgYW4gaW5zdGFuY2Ugb2YgT0RhdGFTdGF0ZSB0byB0aGUgY29udGV4dCBzdGF0ZVwiLCBmdW5jdGlvbiggZG9uZSApIHtcblxuICAgIGNvbnN0IGluaXQgPSBuZXcgaW5pdE1vZHVsZS5Jbml0UGlwZWxpbmVDb21wb25lbnQoe30pO1xuXG4gICAgY29uc3QgY29udGV4dCA9IHtcbiAgICAgIHN0YXRlOiB7fVxuICAgIH07XG5cbiAgICBwaXBlbGluZVV0aWxpdGllcy50ZXN0UGlwZWxpbmVQcm9jZXNzKCBpbml0LCBjb250ZXh0ICkudGhlbiggZnVuY3Rpb24oKSB7XG5cbiAgICAgIGV4cGVjdChjb250ZXh0LnN0YXRlLm9kYXRhKS50by5iZS5hbi5pbnN0YW5jZU9mKHN0YXRlTW9kdWxlLk9EYXRhU3RhdGUpO1xuXG4gICAgfSkudGhlbiggZG9uZSwgZG9uZSApO1xuXG4gIH0pO1xuXG59KTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
